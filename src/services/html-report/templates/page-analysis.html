{% extends "base.html" %}

{% block content %}
<h1>{{ page_type }} Analysis</h1>

<div class="info-grid">
    <div class="info-card">
        <div class="info-label">Organization</div>
        <div class="info-value">{{ organization }}</div>
    </div>
    <div class="info-card">
        <div class="info-label">Page URL</div>
        <div class="info-value">{{ page_url }}</div>
    </div>
    <div class="info-card">
        <div class="info-label">Analysis Date</div>
        <div class="info-value">{{ analysis_date }}</div>
    </div>
</div>

{% if page_analysis.scores and page_analysis.scores.length > 0 %}
<div class="section">
    <h2>Scores</h2>
    {% for score in page_analysis.scores %}
    <div class="score-item">
        <div class="score-label">{{ score.category }}</div>
        <div class="score-bar">
            <div class="score-fill {% if score.score >= 8 %}good{% elif score.score >= 6 %}average{% else %}poor{% endif %}" 
                 style="width: {{ score.score * 10 }}%"></div>
        </div>
        <div class="score-value {% if score.score >= 8 %}good{% elif score.score >= 6 %}average{% else %}poor{% endif %}">
            {{ score.score }}/10
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- Tab navigation -->
<div class="tabs">
    <div class="tab active" data-tab="tab-flaws">Critical Issues</div>
    <div class="tab" data-tab="tab-recommendations">Recommendations</div>
    <div class="tab" data-tab="tab-summary">Summary</div>
    <div class="tab" data-tab="tab-full">Full Analysis</div>
</div>

<div id="tab-flaws" class="tab-content active">
    {% if page_analysis.critical_flaws and page_analysis.critical_flaws.length > 0 %}
    <div class="section">
        <h2>Critical Issues</h2>
        {% for flaw in page_analysis.critical_flaws %}
        <div class="critical-issue">{{ flaw }}</div>
        {% endfor %}
    </div>
    {% else %}
    <div class="section">
        <p>No critical issues were identified for this page.</p>
    </div>
    {% endif %}
</div>

<div id="tab-recommendations" class="tab-content">
    {% if page_analysis.recommendations and page_analysis.recommendations.length > 0 %}
    <div class="section">
        <h2>Recommendations</h2>
        {% for recommendation in page_analysis.recommendations %}
        <div class="recommendation">{{ recommendation }}</div>
        {% endfor %}
    </div>
    {% else %}
    <div class="section">
        <p>No specific recommendations were provided for this page.</p>
    </div>
    {% endif %}
</div>

<div id="tab-summary" class="tab-content">
    <div class="section">
        <h2>Summary</h2>
        {% if page_analysis.summary %}
        <div class="analysis-result">
            <p>{{ page_analysis.summary }}</p>
        </div>
        {% else %}
        <p>No summary available for this page.</p>
        {% endif %}
    </div>
</div>

<div id="tab-full" class="tab-content">
    <div class="section">
        <h2>Complete Analysis</h2>
        {% if page_analysis.full_analysis %}
        <div class="analysis-result">
            <pre>{{ page_analysis.full_analysis }}</pre>
        </div>
        {% else %}
        <p>No detailed analysis available for this page.</p>
        {% endif %}
    </div>
</div>

<div class="section">
    <h2>Page Screenshot</h2>
    <div class="screenshot-container">
        <img src="../screenshots/desktop/{{ screenshot_path }}" alt="{{ page_type }}" class="screenshot">
    </div>
</div>

<div class="navigation">
    <a href="index.html">← Back to Pages</a>
    <a href="../index.html">View Overall Analysis →</a>
</div>
{% endblock %}