{% extends "base.html" %}

{% block title %}{{ page_type }} Analysis Report{% endblock %}
{% block heading %}{{ page_type }} Analysis Report{% endblock %}

{% block additional_styles %}
{{ additional_css }}
{% endblock %}

{% block content %}
    <div class="section">
        <h2>Page Information</h2>
        <div class="org-info">
            <div class="org-info-item">
                <div class="org-info-label">Organization</div>
                <div class="org-info-value">{{ organization }}</div>
            </div>
            <div class="org-info-item">
                <div class="org-info-label">Page Type</div>
                <div class="org-info-value">{{ page_type }}</div>
            </div>
            <div class="org-info-item">
                <div class="org-info-label">Analysis Date</div>
                <div class="org-info-value">{{ analysis_date }}</div>
            </div>
        </div>
    </div>
    
    {% if status == 'error' and error %}
    <div class="section error">
        <h2>Error Information</h2>
        <p>{{ error }}</p>
    </div>
    {% endif %}
    
    {{ score_html|safe }}
    
    {{ tabs_html|safe }}
    
    <div id="tab-flaws" class="tab-content active">
        {{ critical_flaws_html|safe }}
    </div>
    
    <div id="tab-recommendations" class="tab-content">
        {{ recommendations_html|safe }}
    </div>
    
    {{ lighthouse_html|safe }}
    
    <div id="tab-full" class="tab-content">
        <div class="section">
            <h2>Complete Analysis</h2>
            <div class="analysis-result">
                {{ analysis_html|safe }}
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>Page Screenshot</h2>
        <div class="scrollable-screenshot">
            <div class="screenshot-container">
                <img src="{{ screenshot_rel_path }}" alt="{{ page_type }}" class="screenshot">
                <div class="screenshot-caption">{{ page_type }}</div>
            </div>
        </div>
    </div>
    
    <div class="navigation">
        <a href="../index.html">← Back to All Pages</a>
        <a href="../../desktop_screenshot_analysis.html">View Overall Analysis →</a>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab functionality
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding content
                    tab.classList.add('active');
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        });
    </script>
{% endblock %}